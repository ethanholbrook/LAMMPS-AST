# LAMMPS Script: NVE simulation of tungsten in a BCC lattice
# Simulation details:
#   - 16 tungsten atoms arranged in a BCC lattice (2x2x2 unit cell replication)
#   - Equilibration at 3000 K (close to the melting point)
#   - Total simulation time = 7.5 ps with 1000 time samples
#   - LAMMPS compiled with ML-IAP, PYTHON, and ML-SNAP packages (MLIAP_ENABLE_PYTHON, BUILD_SHARED_LIBS)

# ---------- Initialization ----------
units metal                # energy in eV, distance in Å, time in ps, mass in g/mol
dimension 3
boundary p p p             # periodic boundaries in all directions
atom_style atomic

# ---------- Create Geometry ----------
# Define a BCC lattice for tungsten.
# Tungsten has a BCC structure; here we assume a lattice constant ~3.16 Å.
lattice bcc 3.16
# Define a simulation region that will yield 2x2x2 unit cells → 2^3*2 = 16 atoms.
region simbox block 0 2 0 2 0 2
create_box 1 simbox
create_atoms 1 region simbox

# Define the atomic mass for tungsten (~183.84 g/mol)
mass 1 183.84

# ---------- Potential Definition ----------
# Set up the ML-IAP potential.
# Ensure that 'tungsten_model.py' is the correct file (or replace with your model file) for the ML-IAP.
pair_style ml-iap
pair_coeff * * tungsten_model.py W

# ---------- Equilibration ----------
# Initialize velocities to 3000 K with a random seed.
velocity all create 3000.0 12345 mom yes rot no dist gaussian

# ---------- Neighbor List Settings ----------
neighbor 2.0 bin
neigh_modify delay 0 every 1 check yes

# ---------- Time Integration ----------
# Set the time step such that:
# Total simulation time = 7.5 ps; with 1000 steps, dt = 0.0075 ps per step.
timestep 0.0075

# Use the NVE ensemble (constant energy, volume, and number of atoms)
fix 1 all nve

# ---------- Output Settings ----------
# Print thermo info every 100 steps.
thermo 100

# Dump trajectory every 1 step so that we collect 1000 time samples over the run.
dump 1 all custom 1 dump.lammpstrj id type x y z

# ---------- Run Simulation ----------
# Run for 1000 steps, totaling 7.5 ps.
run 1000
