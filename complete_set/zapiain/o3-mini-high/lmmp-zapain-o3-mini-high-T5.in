# ---------------------------
# LAMMPS Input Script for NVE Simulation of Tungsten using ML-IAP
# Simulation Conditions:
#   - 16 tungsten atoms in a BCC lattice (2x2x2 unit cells, 2 atoms/unit cell)
#   - Periodic boundary conditions in all directions
#   - Initial temperature: 3000 K (close to tungsten’s melting point)
#   - Simulation time: 7.5 ps (7500 steps with timestep = 0.001 ps)
#   - Data output: approximately 1000 time samples (~every 8 steps)
#
# Note: This script requires LAMMPS (November 2021 release) compiled with
#       the ML-IAP, PYTHON, and ML-SNAP packages.
#       Ensure the compile flags MLIAP_ENABLE_PYTHON and BUILD_SHARED_LIBS were set.
# ---------------------------

# Set units and atom style
units metal
atom_style atomic

# Define a BCC lattice for tungsten; tungsten's lattice constant is ~3.16 Å.
lattice bcc 3.16
# Create a simulation box containing 2x2x2 unit cells (16 atoms total)
region simbox block 0 2 0 2 0 2 units lattice
create_box 1 simbox
create_atoms 1 box

# Set periodic boundary conditions (by default, create_box uses periodic boundaries)
boundary p p p

# Define neighbor list parameters
neighbor 2.0 bin
neigh_modify delay 10

# Specify the interatomic potential using ML-IAP.
# Replace "tungsten.ml" with your ML potential file and "tungsten" with the element label as needed.
pair_style ml-iap
pair_coeff * * tungsten.ml tungsten

# Initialize velocities at 3000 K using a random seed (here 12345)
velocity all create 3000.0 12345 mom yes rot yes dist gaussian

# Set the integration style: NVE (constant energy) dynamics
fix 1 all nve

# Set the timestep (in metal units, timestep is in ps; 0.001 ps = 1 fs)
timestep 0.001

# Set thermo output frequency to roughly get 1000 samples over 7500 steps.
thermo 8
thermo_style custom step temp pe ke etotal

# Optionally, dump atom positions every 8 steps for trajectory visualization
dump 1 all custom 8 dump.lammpstrj id type x y z

# Run the simulation: 7.5 ps = 7500 timesteps
run 7500

# End of script
