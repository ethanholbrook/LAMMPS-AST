# LAMMPS Script for Spall Failure Simulation in Nb Single Crystals
units           metal
dimension       3
boundary        p p s  # Periodic boundaries in x and y, free in z (impact direction)
atom_style      atomic

# Lattice and region definitions
lattice         bcc 3.3  # Nb BCC lattice parameter in Angstroms (modify if necessary)
region          projectile block 0 20 0 20 0 20 units lattice
region          target block 0 20 0 20 22 62 units lattice  # Target region longer along z-axis

create_box      2 all
create_atoms    1 region projectile
create_atoms    1 region target

# Define potential
pair_style      eam
pair_coeff      * * Nb_Fellinger.eam.alloy Nb

# Group definitions
group           proj region projectile
group           targ region target

# Initial velocities and equilibration
velocity        all create 300.0 12345 mom yes rot yes dist gaussian
fix             nvt all nvt temp 300.0 300.0 0.1

# Equilibrate system for 100 ps
timestep        0.001  # timestep of 1 fs
run             100000  # 100 ps

# Remove thermostat and set up for impact simulation
unfix           nvt
velocity        proj set 0.0 0.0 2000.0  # Add impact velocity to projectile group
fix             nve all nve

# Run the impact simulation
run             500000  # Adjust run time as necessary for desired observation time
