# LAMMPS Script for Spall Failure Simulation in Nb Single Crystals

units           metal
dimension       3
boundary        p p f       # Periodic boundaries along x and y, free along z
atom_style      atomic

# EAM potential for Niobium
pair_style      eam
pair_coeff      * * Nb_eam.alloy Nb  # Make sure Nb_eam.alloy is downloaded and in the working directory

# Lattice and region definitions
lattice        bcc 3.300        # Nb BCC lattice with lattice constant of 3.300 Å (adjust as needed)
region         target block 0 20 0 20 0 40 units lattice
region         projectile block 0 20 0 20 45 65 units lattice

# Create atoms for target and projectile
create_box     1 all
create_atoms   1 region target
create_atoms   1 region projectile

# Assign masses
mass           1 92.906        # Mass of Nb

# Define groups
group          target region target
group          projectile region projectile

# Set velocities for equilibration at 300 K
velocity       all create 300.0 12345 mom yes rot yes dist gaussian

# Equilibrate the system using NVT for 100 ps
timestep       0.001
thermo         1000
fix            1 all nvt temp 300.0 300.0 0.1
run            100000

# Unfix NVT and set impact velocity
unfix          1

# Apply impact velocity to the projectile along the z-direction
velocity       projectile set 0.0 0.0 -2000.0 units box  # -2000 m/s along z (in metal units Å/ps)

# Run the impact and spall failure using NVE (adiabatic conditions)
fix            2 all nve
thermo         1000
run            500000

# End of the script
