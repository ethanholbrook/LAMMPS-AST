# LAMMPS input script for Nb projectile-impact simulation
# Units: metal (length in Angstroms, time in ps, energy in eV, velocity in Angstrom/ps)

# 1. INITIAL SETUP
clear
units          metal
dimension      3
boundary       p p s                # periodic in x,y; free along z
atom_style     atomic

variable       a0    equal 3.30     # approximate lattice constant for Nb in Angstrom
variable       gap   equal 15.0     # 1.5 nm = 15.0 Angstrom

# 2. DEFINE LATTICE & CREATE SIMULATION BOX
#    Orient [100] along x, [010] along y, and [001] along z.
lattice        bcc ${a0} orient x 1 0 0 orient y 0 1 0 orient z 0 0 1

#    Total dimension in z = projectile(20 cells) + gap + target(40 cells).
#    In "units lattice", each "1" along z is one lattice spacing "a0".
#    So 20 lattice cells in z means z-span of 20 "lattice units" = 20*a0.
#    But we want a real gap of 15 Angstrom (1.5 nm), which is gap/a0 in lattice units.
variable zproj equal 20
variable ztarg equal 40
variable zgap  equal ${gap}/${a0}    # gap in "lattice" units
variable zhi   equal ${zproj} + ${zgap} + ${ztarg}

#    Create a simulation domain that spans 20 lattice units in x & y,
#    and (20 + gap + 40) lattice units in z.
region         domain block 0 20 0 20 0 ${zhi} units lattice
create_box     1 domain

# 3. DEFINE REGIONS FOR PROJECTILE AND TARGET
region         projectile block 0 20 0 20 0 20 units lattice
region         target     block 0 20 0 20 (20+${zgap}) ${zhi} units lattice

# 4. CREATE ATOMS
create_atoms   1 region projectile
create_atoms   1 region target

# 5. SET ATOMIC MASS (Niobium ~92.906)
mass           1 92.906

# 6. INTERACTIONS (EAM potential by Fellinger et al. from openKIM or local file)
#    Provide the correct file name for your local EAM potential file or KIM model.
pair_style     eam/fs
pair_coeff     * * Nb_Fellinger.eam.fs Nb   # or use correct Nb label if in file

# 7. GROUP DEFINITIONS
group          gProjectile region projectile
group          gTarget     region target
group          gAll        union gProjectile gTarget

# 8. NEIGHBOR AND OUTPUT SETTINGS
neighbor       2.0 bin
neigh_modify   every 1 delay 0 check yes
thermo_style   custom step time temp pe ke etotal press
thermo         1000

# 9. EQUILIBRATION AT 300 K (ISOCHORIC: NVT, WITH PERIODIC X,Y AND FREE Z)
velocity       gAll create 300.0 12345 dist gaussian mom yes
timestep       0.001               # 1 fs
fix            equil gAll nvt temp 300.0 300.0 0.1
run            100000              # 100 ps = 100,000 timesteps of 1 fs

# 10. REMOVE THERMOSTAT, SET IMPACT VELOCITY, THEN RUN (ADIABATIC: NVE)
unfix          equil
# Add +2 km/s along +z to all projectile atoms (2 km/s = 20 A/ps in metal units)
velocity       gProjectile set 0.0 0.0 20.0 sum yes

fix            impact gAll nve
run            200000              # run another 200 ps, for example