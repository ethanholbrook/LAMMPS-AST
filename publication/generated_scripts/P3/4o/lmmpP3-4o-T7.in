# LAMMPS Script for High-Velocity Impact Simulation on Nb Single Crystals

# Initialization
units metal
dimension 3
boundary p p f  # Periodic in [100] and [010], free in [001]
atom_style atomic

# Atom Definition: Load Nb BCC structure and replicate for projectile and target
lattice bcc 3.30  # Lattice parameter for Nb in Angstroms
region projectile_region block 0 20 0 20 0 20
region target_region block 0 20 0 20 21.5 61.5

create_box 2 all
create_atoms 1 region projectile_region
create_atoms 2 region target_region

group projectile region projectile_region
group target region target_region

# Set up velocities
velocity all create 300.0 12345 mom yes dist gaussian

# Define potential (make sure the file path and potential type match your setup)
pair_style eam/alloy
pair_coeff * * Nb_eam.alloy Nb

# Equilibration for 100 ps at 300 K
fix nvt_equil all nvt temp 300.0 300.0 0.1
thermo 100
timestep 0.001
run 100000

# Unfix NVT and prepare for impact
unfix nvt_equil

# Set up initial impact velocity for the projectile
velocity projectile set 0.0 0.0 -2000.0 sum yes

# Adiabatic conditions (NVE ensemble) for impact and subsequent expansion
fix nve_all all nve

# Simulation output settings
thermo 100
dump mydump all atom 1000 dump.spall
dump_modify mydump scale no

# Run the impact simulation
run 500000

# Clean up
unfix nve_all
