# LAMMPS script for spall failure simulation on Nb single crystals

units           metal
dimension       3
boundary        p p f
atom_style      atomic

# Define lattice and create regions for projectile and target
lattice         bcc 3.3
region          box block 0 20 0 20 0 60 units lattice
create_box      1 box

# Projectile region: Replicate BCC unit cell 20x20x20
region          projectile block 0 20 0 20 0 20 units lattice
create_atoms    1 region projectile

# Target region: Replicate BCC unit cell 20x20x40
region          target block 0 20 0 20 21 60 units lattice
create_atoms    1 region target

# Define potential
pair_style      eam
pair_coeff      * * Nb_Fellinger.eam Nb

# Initial velocities for equilibration
velocity        all create 300.0 12345 mom yes dist gaussian

# Define groups for the projectile and target
group           projectile region projectile
group           target region target

# Equilibration
fix             1 all nvt temp 300.0 300.0 0.1
thermo          100
thermo_style    custom step temp pe ke etotal
timestep        0.001
run             100000

# Remove thermostat for adiabatic conditions
unfix           1

# Apply impact velocity to the projectile atoms along [001]
velocity        projectile set 0.0 0.0 20.0

# Run the impact simulation
fix             2 all nve
run             50000

# Output
dump            1 all atom 1000 dump.nb_spall
dump_modify     1 scale no
