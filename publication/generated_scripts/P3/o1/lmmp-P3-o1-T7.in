# LAMMPS input script for high-velocity impact (spall) simulation in Nb
# using the Fellinger et al. EAM potential.

# (1) Initialization
units           metal
atom_style      atomic
boundary        p p f            # Periodic in x & y, free in z
dimension       3

# (2) Define the lattice and simulation regions
#     (Adjust "latparam" to the equilibrium lattice spacing of Nb for this potential)
variable        latparam equal 3.30      # Example approximate lattice constant (Å)
variable        nx equal 20              # Replications in x for both projectile & target
variable        ny equal 20              # Replications in y for both projectile & target
variable        nzP equal 20             # Replications in z for the projectile
variable        nzT equal 40             # Replications in z for the target
variable        gap  equal 15.0          # 1.5 nm = 15 Å

# Compute dimension in each direction
variable        xhi_proj equal ${nx}*${latparam}
variable        yhi_proj equal ${ny}*${latparam}
variable        zhi_proj equal ${nzP}*${latparam}
variable        zhi_targ equal ${nzT}*${latparam}
# Total box size in z = projectile + gap + target
variable        zhi_box  equal ${zhi_proj}+${gap}+${zhi_targ}

# (3) Create the simulation box
region          simbox block 0.0 ${xhi_proj}  0.0 ${yhi_proj}  0.0 ${zhi_box} units box
create_box      1 simbox

# (4) Define the lattice & create atoms for projectile
#     Use a bcc lattice orientation consistent with [001] along z
lattice         bcc ${latparam}

region          proj block 0.0 ${xhi_proj}  0.0 ${yhi_proj}  0.0 ${zhi_proj} units box
create_atoms    1 region proj

# (5) Create atoms for the target, leaving a 1.5 nm gap
#     That is, the target starts at z = zhi_proj + gap
variable        zlo_targ equal ${zhi_proj}+${gap}
variable        zhi_targRegion equal ${zhi_proj}+${gap}+${zhi_targ}

region          targ block 0.0 ${xhi_proj}  0.0 ${yhi_proj}  ${zlo_targ} ${zhi_targRegion} units box
create_atoms    1 region targ

# (6) Define mass, pair style, and pair coefficients
mass            1 92.906       # Nb atomic mass (amu)

# Example usage of an EAM potential file (local or from KIM).
# Adjust the pair_style and filename/model as appropriate:
# pair_style     eam            # or eam/alloy, eam/fs, or kim
# pair_coeff     * * Nb_Fellinger.eam Nb
pair_style      eam
pair_coeff      * * Nb_Fellinger.eam Nb

# (7) Simulation settings
neighbor        2.0 bin
neigh_modify    delay 10 every 1

# Thermo and dump
thermo          100
thermo_style    custom step time temp press etotal
dump            1 all custom 1000 dump.lammpstrj id type x y z vx vy vz

# (8) Equilibrate at 300 K using an NVT ensemble (isochoric, isothermal)
velocity        all create 300.0 12345 mom yes dist gaussian
fix             equil all nvt temp 300.0 300.0 0.1

timestep        0.001          # 1 fs time step (metal units)
run             100000         # 100 ps total at 0.001 ps/step

unfix           equil

# (9) Impart 2 km/s velocity to the projectile
# 2 km/s = 2000 m/s = 20 Å/ps in metal units
group           projectile region proj
velocity        projectile set 0.0 0.0 20.0 sum yes

# (10) Switch to adiabatic (NVE) to simulate the impact
fix             impact all nve
run             200000         # 200 ps at 0.001 ps/step (adjust as needed)

# End of input script