# LAMMPS script for simulating 2D Lennard-Jones system

units       lj
dimension   2
atom_style  atomic

variable n equal 100
variable sigma equal 1.0
variable epsilon equal 1.0
variable rc equal 3.0
variable mass equal 1.0

# Function to initialize simulation box and particles
define local_init() {
    region mybox block 0 100 0 100 -0.5 0.5 units box
    create_box 1 mybox
    create_atoms 1 random ${n} 12345 mybox
    mass 1 ${mass}
    velocity all create 1.0 12345
}

# Set pair potential
pair_style lj/cut ${rc}
pair_modify shift yes
pair_coeff 1 1 ${epsilon} ${sigma} ${rc}

# Integration settings
variable t_int equal 0.0025 * sqrt(${sigma}^2 * ${mass} / (48 * ${epsilon}))
timestep ${t_int}

# Output settings
thermo 100
thermo_style custom step temp epair etotal press

# Loop over parameter sets
variable rho1 equal 0.75/${sigma}^2
variable rho2 equal 0.8/${sigma}^2

# Define simulation fix
fix 1 all nvt temp 1.0 1.0 0.1

label loop_sets
variable eset loop -1.1 0.55 0.8 -0.3
variable rh eset loop ${rho1} ${rho1} ${rho1} ${rho2}

clear
log log.${eset}.txt

call local_init()

# Set density and energy (per particle)
set type 1 diameter ${sigma}
set type 1 density ${eset}

compute my_temp all temp
fix_modify 1 temp my_temp

# Prepare initial state
minimize 1.0e-4 1.0e-6 100 1000
run 5000

write_restart restart.${eset}.restart

next eset
jump SELF loop_sets