# LAMMPS input script for 16-atom BCC W NVE simulation at 3000 K
# Total simulation time: 7.5 ps
# ~1000 time samples
# Compatible with LAMMPS (Nov 2021 or later) compiled with:
#   ML-IAP, PYTHON, and ML-SNAP packages
#   MLIAP_ENABLE_PYTHON and BUILD_SHARED_LIBS flags.

# -------- Initialization Section --------
units           metal          # time in ps, distance in Angstroms
dimension       3
boundary        p p p
atom_style      atomic

# -------- Create Simulation Box & Atoms --------
# BCC tungsten has 2 atoms per unit cell.
# We choose a 2×2×2 supercell => 16 atoms total.
variable        alat equal 3.165  # Approximate lattice constant for W in Angstroms
lattice         bcc ${alat}
region          box block 0 2 0 2 0 2
create_box      1 box
create_atoms    1 box

# Set mass of tungsten (in g/mol)
mass            1 183.84

# -------- Define Interatomic Potential --------
# Example uses an EAM potential file (e.g. "W_eam.alloy");
# for ML-IAP or ML-SNAP, replace with the relevant pair_style/pair_coeff.
pair_style      eam/alloy
pair_coeff      * * W_eam.alloy W

# -------- Simulation Settings --------
# Initialize velocities at 3000 K
velocity        all create 3000.0 12345 mom yes dist gaussian

# NVE integration
fix             1 all nve

# Time step: in "metal" units, 0.001 ps = 1 fs
timestep        0.001

# You want 7.5 ps total => 7500 steps of 1 fs
# Keep about 1000 samples => output every 7-8 steps
thermo_style    custom step time temp pe ke etotal
thermo          8

# Dump atomic coordinates every 8 steps (~ 938 frames total)
dump            myDump all atom 8 tungsten_nve.lammpstrj
dump_modify     myDump sort id

# -------- Run the Simulation --------
run             7500