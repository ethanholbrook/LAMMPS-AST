# LAMMPS input script for 16-atom BCC tungsten cell near melting (3000 K)
# Compiled with ML-IAP, PYTHON, and ML-SNAP packages (MLIAP_ENABLE_PYTHON, BUILD_SHARED_LIBS)

# ---------- INITIALIZATION ----------

units          metal
atom_style     atomic
boundary       p p p

# ---------- CREATE ATOMS ----------

# 2×2×2 bcc lattice → 16 atoms total
variable       alat equal 3.165           # Approximate lattice constant for W at ~3000 K
lattice        bcc ${alat}
region         box block 0 2 0 2 0 2 units lattice
create_box     1 box
create_atoms   1 box
mass           1 183.84                   # Atomic mass of tungsten

# ---------- POTENTIAL DEFINITION ----------

# Example: EAM potential for tungsten. Substitute if using ML-IAP or ML-SNAP.
pair_style     eam/alloy
pair_coeff     * * W_zhou.eam.alloy W

# If using ML-IAP (as an example):
# pair_style mlip
# pair_coeff * * tungsten-ml.mlip W

neighbor       2.0 bin
neigh_modify   delay 10 every 1

# ---------- EQUILIBRATION AT 3000 K ----------

velocity       all create 3000 12345 mom yes dist gaussian
fix            eq all nvt temp 3000 3000 0.1  # Use NVT to equilibrate
timestep       0.001                          # 1 fs in metal units
run            1000                           # 1 ps of NVT pre-equilibration

# ---------- SWITCH TO NVE AND RUN PRODUCTION ----------

unfix          eq
fix            nve all nve

# Dump atomic coordinates and velocities periodically
# For 6500 steps (6.5 ps), every 7 steps yields ~928 frames (close to 1000).
dump           mydump all custom 7 tungsten_nve.lammpstrj id type x y z vx vy vz

run            6500  # 6.5 ps under NVE → total simulation time = 1 ps (NVT) + 6.5 ps (NVE) = 7.5 ps